{% extends "base.html" %}
{% load static %}
{% block main_content %}

<!-- ================================
    START BREADCRUMB AREA
================================= -->
<section class="breadcrumb-area" style="background-image: url('{{tour_info.tour.imagen_url}}'); background-size: cover; background-position: center; ">
    <div class="breadcrumb-wrap">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-12">
                    <div class="breadcrumb-content">
                        <div class="section-heading">
                            <h2 class="sec__title" style="text-align: center; font-weight: 600; color: white; font-size: 50px;">{{ tour_info.tour.nombre }}</h2>
                        </div>
                    </div><!-- end breadcrumb-content -->
                </div><!-- end col-lg-6 -->
                <div class="col-lg-12">
                    <div class="breadcrumb-list" style="width: fit-content; margin: 10px auto">
                        <ul class="list-items d-flex">
                            <li><a href="/">Explore It</a></li>
                            <li><a href="{% url 'categoria' tour_info.tour.categoria.codigo_url %}">{{tour_info.tour.categoria.nombre}}</a></li>
                            <li>{{ tour_info.tour.nombre }}</li>
                        </ul>
                    </div><!-- end breadcrumb-list -->
                </div><!-- end col-lg-6 -->
            </div><!-- end row -->
        </div><!-- end container -->
    </div><!-- end breadcrumb-wrap -->
</section><!-- end breadcrumb-area -->
<!-- ================================
    END BREADCRUMB AREA
================================= -->

<!-- ================================
    START TOUR DETAIL AREA
================================= -->
<section class="tour-detail-area padding-bottom-90px">
    <div class="single-content-box">
        <div class="container">
            <div class="row pt-5">
                <div class="col-lg-8" style="border-bottom: 1px solid rgba(128, 137, 150, 0);">
                    <div class="single-content-wrap">
                        <div id="description" class="page-scroll">
                            <div class="single-content-item">
                                <div class="section-heading col-lg-12 pl-0" style="height: fit-content !important;">
                                    <h2 class="sec__title line-height-55 pb-1" style="text-align: left;">Descripcion</h2>
                                </div>
                                <p class="py-3" style="text-align: justify;">{{ tour_info.tour.descripcion }}</p>
                            </div><!-- end single-content-item -->
                        </div><!-- end description -->
                    </div><!-- end single-content-wrap -->
                </div><!-- end col-lg-8 -->
                <div class="col-lg-4">
                    <div class="sidebar single-content-sidebar mb-0">
                        <div class="sidebar-widget single-content-widget">
                            <div class="sidebar-widget-item">
                                <div class="sidebar-book-title-wrap mb-3">
                                    <p><span class="text-value mr-1">${{tour_info.tour.precio|floatformat:2}}</span> Por Persona</p>
                                </div>
                            </div><!-- end sidebar-widget-item -->
                            {% if tour_info.tour.esta_disponible %}
                            <div class="sidebar-widget-item">
                                <div class="contact-form-action">
                                    <form action="#">
                                        <div class="form-group">
                                            <label for="salida">Seleccionar Fecha</label>
                                            <select class="form-control" id="salida">
                                                {% for salida in tour_info.proximas_salidas %}<option value="{{ salida.id }}">{{ salida.fecha_salida }}</option>{% endfor %}
                                            </select>
                                        </div>
                                    </form>
                                </div>
                            </div><!-- end sidebar-widget-item -->
                            <div class="sidebar-widget-item">
                                <div class="qty-box mb-2 d-flex align-items-center justify-content-between">
                                    <label class="font-size-16">Pasajeros</label>
                                    <div class="qtyBtn d-flex align-items-center">
                                        <input id="num_pasajeros" type="text" name="qtyInput" value="1">
                                    </div>
                                </div><!-- end qty-box -->
                            </div><!-- end sidebar-widget-item -->
                            <div class="btn-box pt-2">
                                <a  onclick="goToBooking()" class="theme-btn text-center w-100 mb-2" style="color: white;"><i class="la la-shopping-cart mr-2 font-size-18"></i>Realizar Reserva</a>
                            </div>
                            {% else %}
                            <div class="btn-box pt-2">
                                <a  onclick="mostrarInteres()" class="theme-btn text-center w-100 mb-2"><i class="fa fa-exclamation-circle mr-2 font-size-18" aria-hidden="true"></i>Estoy Interesado</a>
                            </div>
                            {% endif %}
                        </div><!-- end sidebar-widget -->
                    </div><!-- end sidebar -->
                </div><!-- end col-lg-4 -->
            </div><!-- end row -->
            {% if tour_info.tour.imagen_descripcion %}
            <div class="row pb-5 pt-4">
                <img src="{{tour_info.tour.imagen_descripcion_url}}" style="width: 100%; height: auto;">
            </div>
            {% else %}
            <div class="row pb-5">
                <div class="section-heading text-center col-lg-12" style="height: fit-content !important; padding-bottom: 25px;">
                    <h2 class="sec__title line-height-55 pb-1 pt-5">Todo lo que Incluye</h2>
                </div>
                {% if tour_info.incluye|length == 5 %}
                    {% for inc in tour_info.incluye %}
                    <div class="col-lg-2 col-sm-6 {%if forloop.counter == 1%}offset-lg-1{%endif%} text-center">
                         <i style="font-size: 70px;" class="las {{inc.icono}}"></i><br>
                        {{inc.nombre}}
                    </div>
                    {% endfor %}
                {% else %}
                    {% for inc in tour_info.incluye %}
                    <div class="col-lg-3 col-sm-6 text-center pb-4">
                         <i style="font-size: 70px;" class="las {{inc.icono}}"></i><br>
                        {{inc.nombre}}
                    </div>
                    {% endfor %}
                {% endif %}
            </div>
            {% endif %}


            {% if tour_info.tour.dificultad or tour_info.tour.altura or tour_info.tour.temperatura or tour_info.tour.trekking %}
            <div class="row pb-5">
                <div class="section-heading text-center col-lg-12" style="height: fit-content !important; padding-bottom: 25px;">
                    <h2 class="sec__title line-height-55 pb-1 pt-5">Detalles</h2>
                </div>
                {% if tour_info.tour.dificultad %}
                <div class="col-lg-2 col-sm-6 offset-lg-1 text-center">
                    <h3 style="min-height: 67px;">{{tour_info.tour.dificultad}}</h3><br>
                    Dificultad
                </div>
                {% endif %}
                {% if tour_info.tour.altura %}
                <div class="col-lg-2 col-sm-6 text-center pb-4">
                    <h3 style="min-height: 67px;">{{tour_info.tour.altura}}</h3><br>
                    Altura Promedio
                </div>
                {% endif %}
                {% if tour_info.tour.temperatura %}
                <div class="col-lg-2 col-sm-6 text-center pb-4">
                    <h3 style="min-height: 67px;">{{tour_info.tour.temperatura}}</h3><br>
                    Temperatura Promedio
                </div>
                {% endif %}
                {% if tour_info.tour.trekking %}
                <div class="col-lg-2 col-sm-6 text-center pb-4">
                    <h3 style="min-height: 67px;">{{tour_info.tour.trekking}}</h3><br>
                    Tiempo de trekking
                </div>
                {% endif %}
                <div class="col-lg-2 col-sm-6 text-center pb-4">
                    <h3 style="min-height: 67px;">{% if tour_info.tour.pet_friendly %}SI{% else %}NO{% endif %}</h3><br>
                    Pet Friendly
                </div>
            </div>
            {% endif %}


            <div class="row pb-5">
                <div class="section-heading text-center col-lg-12" style="height: fit-content !important; padding-bottom: 25px;">
                    <h2 class="sec__title line-height-55 pb-1 pt-5">Itinerario</h2>
                </div>
                <div id="itinerary" class="col-lg-10 row" style="box-shadow: 0 0 20px #cccccc7d; border-radius: 20px; padding: 25px; margin: auto;">
                    <div class="single-content-item col-lg-8">
                        {% for dia, actividades in tour_info.itinerario.items %}
                                <p style="font-weight: bold;">Dia {{dia}}</p>
                                {% for descripcion in actividades %}
                                <div id="faqCollapse{{forloop.counter}}" class="collapse show" aria-labelledby="faqHeadingOne" data-parent="#accordionExample">
                                    <div class="card-body d-flex align-items-center" style="padding: 0px;">
                                        <p><i class="las la-minus"></i> {{descripcion}}</p>
                                    </div>
                                </div>
                                {% endfor %}
                        <br>
                        {% endfor %}
                    </div><!-- end single-content-item -->
                    <div class="single-content-item col-lg-4 text-center">
                        <i class="las la-clipboard-list" style="font-size: 150px;"></i>
                    </div><!-- end single-content-item -->
                </div><!-- end itinerary -->
            </div>
        </div><!-- end container -->
    </div><!-- end single-content-box -->
</section><!-- end tour-detail-area -->
<!-- ================================
    END TOUR DETAIL AREA
================================= -->

<!-- ================================
    START RELATE TOUR AREA
================================= -->
<section class="related-tour-area section--padding">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="section-heading text-center">
                    <h2 class="sec__title">Destinos Similares</h2>
                </div><!-- end section-heading -->
            </div><!-- end col-lg-12 -->
        </div><!-- end row -->
        <div class="row padding-top-50px">
            {% for tour in similares %}
            <div class="col-lg-4 responsive-column" style="padding: 0 40px 40px 40px;">
                <div class="card-item mb-0">
                    <a href="{% url 'tour_info' tour.token %}" class="btn-text"><div class="card-img" style="background-image: url('{% if tour.imagen %}{{tour.imagen_url}}{% else %}{% static 'images/logo.png' %}{% endif %}'); background-size: cover; background-position: center; height: 220px;"></div></a>
                    <div class="card-body">
                        <h3 class="card-title"><a href="{% url 'tour_info' tour.token %}">{{tour.nombre}}</a></h3>
                        <p class="card-meta"><i class="las la-map-marker-alt"></i> {{tour.ubicacion}}</p>
                        <div class="card-price d-flex align-items-center justify-content-between">
                            <p>
                                <span class="price__num">${{tour.precio|floatformat:2}}</span>
                                <span class="price__text">Por persona</span>
                            </p>
                            <a href="{% url 'tour_info' tour.token %}" class="btn-text">Detalles<i class="la la-angle-right"></i></a>
                        </div>
                    </div>
                </div><!-- end card-item -->
            </div>
            {% endfor %}
        </div><!-- end row -->
    </div><!-- end container -->
</section><!-- end related-tour-area -->
<!-- ================================
    END RELATE TOUR AREA
================================= -->
{% endblock %}
{% block footer_code %}
<script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<script>
    function goToBooking(){
        var num_pasajeros = document.getElementById('num_pasajeros').value
        var salida = document.getElementById('salida').value
        window.location.href = '{% url 'tour_booking' tour_info.tour.token %}'+'?sal='+String(salida)+'&pas='+String(num_pasajeros)
    }

    function mostrarInteres(){
        Swal.fire({
          title: 'Mostrar Interés',
          text: 'Al mostrar interés se le enviará un correo electrónico apenas una salida para este Tour sea programada. Indíquenos su correo electrónico.',
          input: 'text',
          icon: 'info',
          inputAttributes: {
            autocapitalize: 'off',
            placeholder: 'Correo Electrónico'
          },
          showCancelButton: true,
          confirmButtonText: 'Enviar',
          showLoaderOnConfirm: true
        }).then((result) => {
          if (result.isConfirmed) {
            $.ajax({
              type: "POST",
              url: "{% url 'mostrar_interes' %}",
              data: {csrfmiddlewaretoken: '{{ csrf_token }}', tour: '{{tour_info.tour.token}}', correo: result.value},
              success:function(response){
                if(response.status == 200){
                    Swal.fire({
                      icon: 'success',
                      title: 'Gracias!',
                      text: 'Exploreit agradece tu interés.',
                    })
                }else{}
              },
            });
          }
        })
    }
</script>

<style>

    .single-content-widget{
        border-radius: 20px;
    }

    .single-content-sidebar{
        margin-top: 0px;
    }

    .section-heading{
        height: fit-content !important;
    }

    .title{
        color: #77798D !important;
    }

    .card-item.destination-card .card-body{
      display: none !important;
    }

    .section-heading{
      height: 130px;
    }

    .section-heading h2{
      text-align: center;
    }

    .contact-form-action .form-control {
        padding: 10px 20px 10px 10px !important;
    }

    .bread-bg-2 {
        background-image: url('{% if tour_info.tour.imagen %}{{settings.MEDIA_URL}}{{ tour_info.tour.imagen }}{% else %}{% static 'images/logo.png' %}{% endif %}') !important;
    }

    .btn-box a{
        color: white;
    }
</style>
{% endblock %}